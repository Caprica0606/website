/* 
Quick.Box.Lite v1.3
License:
  Code in this file (or any part of it) can be used only as part of Quick.Cms v6.3 or later. All rights reserved by OpenSolution.

Source files: http://opensolution.org/docs/qcms_v6/download/v6.3-js-src-plus-gulp-free.zip
*/
var oQuickBox=null;!function(i){i.fn.quickbox=function(e){function n(e,n){var o=i(n).attr("class");i(n).click(function(i){i.preventDefault()});var t=o.indexOf("["),a=o.indexOf("]"),u=o.substr(t+1,a-t-1);p[u]||(""==u&&(u="single"),p[u]||(p[u]=[])),p[u]&&(p[u][p[u].length]=i(n),i(n).on("click",{sIndex:u,iImage:p[u].length-1},function(i){s(this,i.data.sIndex,i.data.iImage)}))}function o(e){37==e.keyCode&&i("#quick-box .prev:visible").length>0?l("prev"):null,39==e.keyCode&&i("#quick-box .next:visible").length>0?l("next"):null,27==e.keyCode?i("#quick-box").remove():null}function t(){i("#quick-box .image-wrapper img").length&&i("#quick-box .image-wrapper img").remove(),g(),i("#quick-box .prev span, #quick-box .next span").hide(),i("#quick-box .image-wrapper .loading").remove(),i("#quick-box .image-wrapper").append(oConfig.sLoading),i("#quick-box .description").hide(),i('<img src="'+p[sQuickGallery][iCurrentImage].attr("href")+'"/>').load(function(){i("#quick-box .prev span, #quick-box .next span").show(),i("#quick-box .image-wrapper .loading").remove(),i("#quick-box .image-wrapper").append(i(this)),i("#quick-box .description").remove(),"undefined"!=typeof p[sQuickGallery][iCurrentImage].attr("title")&&""!=p[sQuickGallery][iCurrentImage].attr("title")&&i("#quick-box .quick-box-container").append('<p class="description">'+p[sQuickGallery][iCurrentImage].attr("title")+"</p>").show(),d(),g()})}function a(e){i("#quick-box .image-wrapper").removeClass("image-wrapper").addClass("content-wrapper"),i("#quick-box .prev, #quick-box .next").remove(),i("#quick-box .content-wrapper").prepend(i("."+e).clone()),i("#quick-box .content-wrapper ."+e).show(),u()}function u(){iTopPos=Math.round((i(window).height()-i("#quick-box .content-wrapper").height())/2)+"px",iLeftPos=Math.round((i(window).width()-i("#quick-box .content-wrapper").width())/2)+"px",i("#quick-box .quick-box-container").animate({top:iTopPos,left:iLeftPos})}function c(i){var e=i.iImageHeight>0?Math.round(i.iImageHeight/i.iImageWidth*100)/100:0;return e>=1?(i.iWindowHeight<i.iImageHeight||i.iWindowWidth<i.iImageWidth)&&(i.iImageHeight=i.iWindowHeight,i.iImageWidth=Math.round(i.iImageHeight/e),i.iWindowWidth<i.iImageWidth&&(i.iImageWidth=i.iWindowWidth,i.iImageHeight=Math.round(i.iImageWidth*e)),r(i)):e>0&&(i.iWindowWidth<i.iImageWidth||i.iWindowHeight<i.iImageHeight)&&(i.iImageWidth=i.iWindowWidth,i.iImageHeight=Math.round(i.iImageWidth*e),i.iWindowHeight<i.iImageHeight&&(i.iImageHeight=i.iWindowHeight,i.iImageWidth=Math.round(i.iImageHeight/e)),r(i)),i}function r(e){i("#quick-box .quick-box-container img").css({height:e.iImageHeight+"px",width:e.iImageWidth+"px"}),i("#quick-box .description").css({position:"absolute",bottom:"0px"});var n=parseInt(i("#quick-box .description").height())+10;i("#quick-box .image-wrapper .navigation").css("bottom",n+"px"),oConfig.bFullSizeLink===!0&&(i("#quick-box .navigation .full-size").remove(),i("#quick-box .navigation").append('<a href="'+p[sQuickGallery][iCurrentImage].attr("href")+'" class="full-size" target="_blank">Full size</a>'))}function g(){var e=null,n=null,o=null,t={iWindowHeight:i(window).height(),iWindowWidth:i(window).width(),iImageHeight:i("#quick-box .quick-box-container img").height(),iImageWidth:i("#quick-box .quick-box-container img").width()};t=c(t),i("#quick-box .description").css({width:t.iImageWidth+"px"}),e=i("#quick-box .quick-box-container").height(),n=Math.round((t.iWindowHeight-t.iImageHeight)/2)+"px",o=Math.round((t.iWindowWidth-t.iImageWidth)/2)+"px",i("#quick-box .quick-box-container").css({top:n,left:o})}function d(){i("#quick-box .close").show(),0==iCurrentImage||"single"==sQuickGallery?i("#quick-box .prev").hide():i("#quick-box .prev").show(),iCurrentImage==h-1||"single"==sQuickGallery?i("#quick-box .next").hide():i("#quick-box .next").show(),i("#quick-box .navigation").length?i("#quick-box .navigation").remove():null,h>1&&"single"!=sQuickGallery?i("#quick-box .image-wrapper").append('<p class="navigation">'+(iCurrentImage+1)+"/"+h+"</p>"):null}function l(e,n){if("prev"==e&&iCurrentImage-1>-1){iCurrentImage-=1;var o=!0}if("next"==e&&iCurrentImage+1<h){iCurrentImage+=1;var o=!0}if(o)if(n){var a=i(window).width();"next"==e&&(a="-"+i("#quick-box .quick-box-container").width()),i("#quick-box .quick-box-container").animate({left:a+"px"},500,function(){t(),o=null})}else t(),o=null}function s(e,n,c){var r,d,s="undefined"!=typeof i(e).attr("data-quickbox-msg");if(!i("#quick-box").length){i("body").append('<div id="quick-box" onkeypress="keyUpHandler" ><div class="background"></div><div class="quick-box-container"><div class="image-wrapper"></div></div></div>'),sQuickGallery=n,iCurrentImage=c,h=p[sQuickGallery].length,"string"==typeof oConfig.sNavOutside&&("arrows"==oConfig.sNavOutside&&(r=!0),"close"==oConfig.sNavOutside&&(d=!0),"all"==oConfig.sNavOutside&&(r=d=!0)),i("#quick-box "+("undefined"!=typeof d?"":".image-wrapper")).prepend('<a href="#" class="close" aria-label="close">x</a>'),i("#quick-box "+("undefined"!=typeof r?"":".image-wrapper")).prepend('<a href="#" class="prev"><span>&#60;</span></a><a href="#" class="next"><span>&#62;</span></a>'),s===!0?a(i(e).attr("data-quickbox-msg")):t(),"single"!=sQuickGallery&&(i("#quick-box").on("swipeleft",function(){l("next",!0)}),i("#quick-box").on("swiperight",function(){l("prev",!0)}),i(window).on("orientationchange",function(i){t()})),i(window).resize(function(){s===!0?u():(i("#quick-box .quick-box-container img").css({height:"auto",width:"auto"}),g())});var k=function(e){e.preventDefault(),i("#quick-box").remove(),document.onkeyup=null};i("#quick-box .background, #quick-box .close").click(function(i){k(i)}),i("#quick-box .close-box").length>0&&i("#quick-box .close-box").click(function(i){k(i)}),i("#quick-box .prev").click(function(i){l("prev"),i.preventDefault()}),i("#quick-box .next").click(function(i){l("next"),i.preventDefault()}),i("#quick-box")&&(document.onkeyup=o)}}var p={},h=0;return iCurrentImage=0,sQuickGallery=null,aDefault={sNavOutside:"null",bFullSizeLink:!0,sLoading:'<span class="loading">Loading...</span>'},oConfig={},oConfig=i.extend({},aDefault,e),this.each(n),this.changeContentPosition=u,this.addLinkToCache=n,this}}(jQuery);